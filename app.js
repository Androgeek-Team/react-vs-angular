/*! risk-register 2014-05-06 11:04:50 */
var RiskImpact=React.createClass({render:function(){return React.DOM.span({className:"label label-success"},this.props.impact)}}),RiskLine=React.createClass({getInitialState:function(){return{statusList:["danger","warning","success"]}},getRowClass:function(a){return this.state.statusList.length<1+a?"":this.state.statusList[a]},render:function(){return React.DOM.tr({className:this.getRowClass(this.props.risk.status.id)},[React.DOM.td({},this.props.risk.id),React.DOM.td({},this.props.risk.name),React.DOM.td({},this.props.risk.owner.name),React.DOM.td({className:"text-center"},[this.props.risk.probability<4?RiskProbability({probability:this.props.risk.probability}):null]),React.DOM.td({className:"text-center"},[this.props.risk.probability>3&&this.props.risk.probability<7?RiskProbability({probability:this.props.risk.probability}):null]),React.DOM.td({className:"text-center"},[this.props.risk.probability>6?RiskProbability({probability:this.props.risk.probability}):null]),React.DOM.td({className:"text-center"},[this.props.risk.impact<4?RiskImpact({impact:this.props.risk.impact}):null]),React.DOM.td({className:"text-center"},[this.props.risk.impact>3&&this.props.risk.impact<7?RiskImpact({impact:this.props.risk.impact}):null]),React.DOM.td({className:"text-center"},[this.props.risk.impact>6?RiskImpact({impact:this.props.risk.impact}):null]),React.DOM.td({className:"text-center"},this.props.risk.probability*this.props.risk.impact),React.DOM.td({className:"impact-area text-center"},this.props.risk.areas.indexOf(0)>-1?"X":""),React.DOM.td({className:"impact-area text-center"},this.props.risk.areas.indexOf(1)>-1?"X":""),React.DOM.td({className:"impact-area text-center"},this.props.risk.areas.indexOf(2)>-1?"X":""),React.DOM.td({},this.props.risk.plan),React.DOM.td({},RiskStatus({status:this.props.risk.status})),React.DOM.td({},"[action]")])}}),RiskList=React.createClass({getInitialState:function(){return{risks:[]}},componentDidMount:function(){var a=this;jQuery.get("/risks.json",function(b){a.setState({risks:b})},"json")},render:function(){var a=this.state.risks.map(function(a){return RiskLine({risk:a})});return EventSystem.publish("risk.count.update",this.state.risks.length),React.DOM.table({className:"table table-hover table-bordered risk-table"},[React.DOM.thead({},[React.DOM.tr({},[React.DOM.td({colSpan:3}),React.DOM.td({className:"text-center",colSpan:3},"Probability"),React.DOM.td({className:"text-center",colSpan:3},"Impact"),React.DOM.td({}),React.DOM.td({className:"text-center",colSpan:3},"Impact areas"),React.DOM.td({colSpan:3})]),React.DOM.tr({},[React.DOM.td({}),React.DOM.td({},"Source"),React.DOM.td({}),React.DOM.td({className:"list-section-left"},"Low"),React.DOM.td({className:"list-section-center"},"Medium"),React.DOM.td({className:"list-section-right"},"High"),React.DOM.td({className:"list-section-left"},"Low"),React.DOM.td({className:"list-section-center"},"Medium"),React.DOM.td({className:"list-section-right"},"High"),React.DOM.td({},"Result"),React.DOM.td({className:"list-section-left"},"Cost"),React.DOM.td({className:"list-section-center"},"Schedule"),React.DOM.td({className:"list-section-right"},"Performance"),React.DOM.td({},"Plan"),React.DOM.td({},"Status"),React.DOM.td({})])]),React.DOM.tbody({},a)])}}),RiskPage=React.createClass({updateRiskCount:function(a){this.setState({riskCount:a})},componentDidMount:function(){EventSystem.subscribe("risk.count.update",this.updateRiskCount)},getInitialState:function(){return{riskCount:0}},render:function(){return React.DOM.div({},[React.DOM.button({className:"btn btn-success pull-right"},[React.DOM.span({className:"glyphicon glyphicon-plus"})," Add new Risk"]),React.DOM.h1({className:"page-header"},[React.DOM.span({},"Risk Register "),React.DOM.small({},this.riskCountText())]),RiskList({})])},riskCountText:function(){return this.state.riskCount<1?"":this.state.riskCount<2?this.state.riskCount+" risk":this.state.riskCount+" risks"}}),RiskProbability=React.createClass({getInitialState:function(){return{statusList:["label-danger","label-warning","label-success"]}},getLabelClass:function(a){return 4>a?"label-success":a>6?"label-danger":"label-warning"},render:function(){return React.DOM.span({className:"label "+this.getLabelClass(this.props.probability)},this.props.probability)}}),RiskStatus=React.createClass({getInitialState:function(){return{statusList:["label-danger","label-warning","label-success"]}},getLabelClass:function(a){return this.state.statusList.length<1+a&&(a=0),this.state.statusList[a]},render:function(){return React.DOM.span({className:"label "+this.getLabelClass(this.props.status.id)},this.props.status.name)}}),EventSystem=function(){var a=this;return a.queue={},{publish:function(b,c){var d=a.queue[b];if("undefined"==typeof d)return!1;for(;d.length>0;)d.shift()(c);return!0},subscribe:function(b,c){"undefined"==typeof a.queue[b]&&(a.queue[b]=[]),a.queue[b].push(c)}}}(),getHtmlParam=function(a){return jQuery('param[name="'+a+'"]').attr("value")};React.renderComponent(RiskPage({}),document.getElementById("risk-page"));
